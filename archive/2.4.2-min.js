(function(f,p,H){function s(e){var f=(new Date).getTime()/1E3,a=parseInt(f,10);return e?f:Math.round(1E3*(f-a))/1E3+" "+a}function q(e){p.log("@"+((s(!0)-t).toString(10)+"        ").substr(0,8)+", PQUEUE: "+e)}function k(e){p.warn("@"+((s(!0)-t).toString(10)+"        ").substr(0,8)+", PQUEUE: "+e)}function I(e){return"object"!==typeof e||"function"!==typeof e.constructor||"string"!==typeof e.constructor.name?!1:"Array"===e.constructor.name}p===H&&(p={log:function(){},warn:function(){}});var t=s(!0),
J=[],A=function(){function e(){!1===b.clock&&(b.clock=f.setInterval(A,0))}function p(){!1!==b.clock&&(f.clearInterval(b.clock),b.clock=!1)}function a(a,c){var d=Boolean(b.status&c);a!==H&&(b.status=a?b.status|c:b.status&~c);return d}function s(){a(0>b.processCounter,B);a(b.processCounter>=b.processStack.length,C);a(b.nextProcess===K,D);a(b.nextProcess===L,M);a("function"!==typeof b.nextProcess,E);var N=a(void 0,B)||a(void 0,C)||a(void 0,E);a(N,u)}function v(a){"number"===typeof a&&(b.processCounter=
a,b.nextProcess=b.processStack[b.processCounter],s())}function t(){a(void 0,u)||v(b.processCounter+1)}function F(){a(void 0,m)&&(a(!1,m),q("["+b.name+"].halt"),p())}function A(){if(a(void 0,m)&&!a(void 0,n)&&!a(void 0,w))if(a(!0,w),q("["+b.name+"].tick"),a(void 0,u)){k("Has error(s)");a(!1,w);k("pcUnderflow: "+Boolean(a(void 0,B)));k("pcOverflow: "+Boolean(a(void 0,C)));k("pcAtNoOp: "+Boolean(a(void 0,E)));k("pcAtHalt: "+Boolean(a(void 0,D)));for(k("pcAtBarrier: "+Boolean(a(void 0,M)));0<b.errorMessages.length;)k(b.errorMessages.shift());
F()}else if(a(void 0,D))a(!1,w),F();else{var c=b.processCounter,d=b.nextProcess;t();q("PC:"+c+">>"+d.name);a(!0,G);try{d.call(x,x,x.heap)}catch(e){c=e.message,a(!0,u),b.errorMessages.push("string"===typeof c?c:"")}a(!1,G);a(!1,w)}}var d=null,c=[],g=0,h="",c=typeof arguments[0],l=typeof arguments[1],r=typeof arguments[2],y=typeof arguments[3];switch(arguments.length){case 1:if("string"===c)return J[arguments[0]];if("object"===c)if(I(arguments[0]))c=arguments[0];else if(I(arguments[0].processArray))d=
"object"===typeof arguments[0].parent?arguments[0].parent:null,c=arguments[0].processArray,g="number"===typeof arguments[0].initialProcessID?arguments[0].initialProcessID:0,h="string"===typeof arguments[0].queueName?arguments[0].queueName:"";else return null;else return null;break;case 2:if("object"===c&&"object"===l)d=arguments[0],c=arguments[1],g=0,h="";else if("object"===c&&"number"===l)d=null,c=arguments[0],g=arguments[1],h="";else if("object"===c&&"string"===l)d=null,c=arguments[0],g=0,h=arguments[1];
else return null;break;case 3:if("object"===c&&"object"===l&&"number"===r)d=arguments[0],c=arguments[1],g=arguments[2],h="";else if("object"===c&&"object"===l&&"string"===r)d=arguments[0],c=arguments[1],g=0,h=arguments[2];else if("object"===c&&"number"===l&&"string"===r)d=null,c=arguments[0],g=arguments[1],h=arguments[2];else return null;break;case 4:if("object"===c&&"object"===l&&"number"===r&&"string"===y)d=arguments[0],c=arguments[1],g=arguments[2],h=arguments[3];else return null;break;default:return null}"number"!==
typeof g&&(g=0);q("Instantiating new process queue.");if("object"!==typeof c)return k("Invalid argument[1]. Expecting an Object."),k("Returning NULL."),null;q("Generating new process queue object.");for(var b={clock:!1,parent:d&&"object"===typeof d&&d.PQUEUE?d:null,name:"",status:0,errorMessages:[],processStack:[],processIndexs:[],processCounter:0,nextProcess:null,sharedHeap:{},wakerStack:[]},G=1,w=2,m=4,n=8,u=16,B=32,C=64,D=128,M=256,E=512,x={heap:b.sharedHeap,heap_dump:function(){var a="",c;for(c in b.sharedHeap)""!==
a&&(a+=", \n"),a+=c+":"+b.sharedHeap[c];return"{\n"+a+"\n}"},pause:function(c){a(void 0,G)&&!a(void 0,n)&&a(void 0,m)&&!a(void 0,n)&&(a(!0,n),p(),"number"===typeof c&&b.wakerStack.push(f.setTimeout(x.resume,c)))},resume:function(){if(a(void 0,n)&&a(void 0,m)&&a(void 0,n)){for(a(!1,n);0<b.wakerStack.length;)f.clearTimeout(b.wakerStack.shift());e()}},pc:{increment:t,decrement:function(){a(void 0,u)||v(b.processCounter-1)},offset:function(a){"number"===typeof a&&(b.processCounter+=a,b.nextProcess=b.processStack[b.processCounter],
s())},"goto":v,locate:function(a){a=b.processIndexs[String(a)];return"number"===typeof a?a:-1},valueOf:function(){return b.processCounter},toString:function(){return"function"===typeof b.nextProcess?b.nextProcess.name:String(b.processCounter)}},isPaused:function(){return a(void 0,n)},parent:b.parent},z={boot:function(){a(void 0,m)||(a(!0,m),q("["+b.name+"].boot"),e());return z},halt:function(){F();return z},reset:function(){a(void 0,m)||(q("["+b.name+"].reset"),v(g));return z}},d=0,l=c.length;d<l;++d){var r=
c[d],y=r.name,O=b.processStack.length;b.processStack.push(r);""!==y&&(b.processIndexs[y]=O)}v(g);"string"===typeof h&&""!==h?(b.name=h,J[h]=x):b.name=String((new Date).getTime());return z},K=function(){},L=function(e){e.pause()};A.PQUEUE="2.4.2";"object"===typeof f&&"object"===typeof f.document&&(f.PQUEUE=A,f.PQUEUE_HALT=K,f.PQUEUE_BARRIER=L)})(window,console);
