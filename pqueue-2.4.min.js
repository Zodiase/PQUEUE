;(function(window,console,undefined){if(console===undefined){c={log:function(){},warn:function(){}};}
function microtime(get_as_float){var now=new Date().getTime()/1000;var s=parseInt(now,10);return(get_as_float)?now:(Math.round((now-s)*1000)/1000)+' '+s;}
var startTime=microtime(true);function elapsedTime(){return microtime(true)-startTime;}
function log(msg){console.log('@'+(elapsedTime().toString(10)+'        ').substr(0,8)+', PQUEUE: '+msg);}
function warn(msg){console.warn('@'+(elapsedTime().toString(10)+'        ').substr(0,8)+', PQUEUE: '+msg);}
function isArray(obj){if(typeof obj!=='object')return false;if(typeof obj.constructor!=='function')return false;if(typeof obj.constructor.name!=='string')return false;return(obj.constructor.name==='Array');}
var queueStack=[];var PQUEUE=function(){"use strict";var parent=null,processArray=[],initialProcessID=0,queueName='';switch(arguments.length){case 1:var arg1Type=typeof arguments[0];if(arg1Type==='string'){return queueStack[arguments[0]];}else if(arg1Type==='object'){if(isArray(arguments[0])){processArray=arguments[0];}else if(isArray(arguments[0].processArray)){parent=(typeof arguments[0].parent==='object')?arguments[0].parent:null;processArray=arguments[0].processArray;initialProcessID=(typeof arguments[0].initialProcessID==='number')?arguments[0].initialProcessID:0;queueName=(typeof arguments[0].queueName==='string')?arguments[0].queueName:'';}else{return null;}}else{return null;}
break;case 2:var arg1Type=typeof arguments[0],arg2Type=typeof arguments[1];if(arg1Type==='object'&&arg2Type==='object'){parent=arguments[0];processArray=arguments[1];initialProcessID=0;queueName='';}else if(arg1Type==='object'&&arg2Type==='number'){parent=null;processArray=arguments[0];initialProcessID=arguments[1];queueName='';}else if(arg1Type==='object'&&arg2Type==='string'){parent=null;processArray=arguments[0];initialProcessID=0;queueName=arguments[1];}else{return null;}
break;case 3:var arg1Type=typeof arguments[0],arg2Type=typeof arguments[1],arg3Type=typeof arguments[2];if(arg1Type==='object'&&arg2Type==='object'&&arg3Type==='number'){parent=arguments[0];processArray=arguments[1];initialProcessID=arguments[2];queueName='';}else if(arg1Type==='object'&&arg2Type==='object'&&arg3Type==='string'){parent=arguments[0];processArray=arguments[1];initialProcessID=0;queueName=arguments[2];}else if(arg1Type==='object'&&arg2Type==='number'&&arg3Type==='string'){parent=null;processArray=arguments[0];initialProcessID=arguments[1];queueName=arguments[2];}else{return null;}
break;case 4:var arg1Type=typeof arguments[0],arg2Type=typeof arguments[1],arg3Type=typeof arguments[2],arg4Type=typeof arguments[3];if(arg1Type==='object'&&arg2Type==='object'&&arg3Type==='number'&&arg4Type==='string'){parent=arguments[0];processArray=arguments[1];initialProcessID=arguments[2];queueName=arguments[3];}else{return null;}
break;default:return null;}
if(arguments.length===2&&typeof arguments[0]==='object'&&typeof arguments[1]==='object'){parent=arguments[0];processArray=arguments[1];}
if(arguments.length===2&&typeof arguments[0]==='object'&&typeof arguments[1]==='object'){parent=arguments[0];processArray=arguments[1];}
log('Instantiating new process queue.');if(typeof processArray!=='object'){warn('Invalid argument[1]. Expecting an Object.');warn('Returning NULL.');return null;}
log('Generating new process queue object.');var PQ={clock:0,parent:(parent&&typeof parent==='object'&&parent.PQUEUE)?parent:null,name:'',status:0,errorMessages:[],processStack:[],processIndexs:[],processCounter:0,nextProcess:null,sharedHeap:{},wakerStack:[]},FLAG_RUNNING=0x001,FLAG_TICKING=0x002,FLAG_BOOTED=0x004,FLAG_PAUSED=0x008,FLAG_GENERR=0x010,FLAG_PCUNDER=0x020,FLAG_PCOVER=0x040,FLAG_PCHALT=0x080,FLAG_PCBAR=0x100,FLAG_PCNOOP=0x200,api={heap:PQ.sharedHeap,heap_dump:PQ.dumpSharedHeap,pause:function(time){if(queueIsRunning()&&!queueIsPaused())pauseQueue(time);},resume:function(){if(queueIsPaused())resumeQueue();},pc:{increment:pcIncrement,decrement:pcDecrement,offset:pcOffset,goto:pcGoto,locate:pcReference,valueOf:valueOfPC,toString:PCtoString},isPaused:function(){return queueIsPaused();},parent:PQ.parent},wrapper={boot:bootQueue,halt:haltQueue};function dumpSharedHeap(){var result='';for(var key in PQ.sharedHeap){if(result!=='')result+=', \n';result+=key+':'+PQ.sharedHeap[key];}
return'{\n'+result+'\n}';}
function cleanSharedHeap(){PQ.sharedHeap.length=0;}
function _statIs(setValue,flag){var returnValue=Boolean(PQ.status&flag);if(setValue!==undefined){if(setValue)PQ.status|=flag;else PQ.status&=~flag;}
return returnValue;}
function queueIsRunning(setValue){return _statIs(setValue,FLAG_RUNNING);}
function queueIsTicking(setValue){return _statIs(setValue,FLAG_TICKING);}
function queueIsBooted(setValue){return _statIs(setValue,FLAG_BOOTED);}
function queueIsPaused(setValue){return _statIs(setValue,FLAG_PAUSED);}
function queueError(setValue){return _statIs(setValue,FLAG_GENERR);}
function pcUnderflow(setValue){return _statIs(setValue,FLAG_PCUNDER);}
function pcOverflow(setValue){return _statIs(setValue,FLAG_PCOVER);}
function pcAtHalt(setValue){return _statIs(setValue,FLAG_PCHALT);}
function pcAtBarrier(setValue){return _statIs(setValue,FLAG_PCBAR);}
function pcAtNoOp(setValue){return _statIs(setValue,FLAG_PCNOOP);}
function clearPcStatus(){pcUnderflow(false);pcOverflow(false);pcAtHalt(false);pcAtBarrier(false);pcAtNoOp(false);}
function updatePcStatus(){pcUnderflow(PQ.processCounter<0);pcOverflow(PQ.processCounter>=PQ.processStack.length);pcAtHalt(PQ.nextProcess===PQUEUE_HALT);pcAtBarrier(PQ.nextProcess===PQUEUE_BARRIER);pcAtNoOp(typeof PQ.nextProcess!=='function');queueError(pcUnderflow()||pcOverflow()||pcAtNoOp());}
function pcGoto(newPc){if(typeof newPc!=='number')return;PQ.processCounter=newPc;PQ.nextProcess=PQ.processStack[PQ.processCounter];updatePcStatus();}
function pcIncrement(){if(queueError())return;pcGoto(PQ.processCounter+1);}
function pcDecrement(){if(queueError())return;pcGoto(PQ.processCounter-1);}
function pcOffset(offset){if(typeof newPc!=='number')return;PQ.processCounter+=newPc;PQ.nextProcess=PQ.processStack[PQ.processCounter];updatePcStatus();}
function pcReference(funcName){var index=PQ.processIndexs[String(funcName)];return(typeof index==='number')?index:-1;}
function valueOfPC(){return PQ.processCounter;}
function PCtoString(){return(typeof PQ.nextProcess==='function')?PQ.nextProcess.name:String(PQ.processCounter);}
function fireError(message){queueError(true);PQ.errorMessages.push((typeof message==='string')?message:'');}
function throwErrors(){warn('pcUnderflow: '+Boolean(pcUnderflow()));warn('pcOverflow: '+Boolean(pcOverflow()));warn('pcAtNoOp: '+Boolean(pcAtNoOp()));warn('pcAtHalt: '+Boolean(pcAtHalt()));warn('pcAtBarrier: '+Boolean(pcAtBarrier()));while(PQ.errorMessages.length>0){warn(PQ.errorMessages.shift());}}
function bootQueue(){if(queueIsBooted())return;queueIsBooted(true);log('['+PQ.name+'].boot');PQ.clock=window.setInterval(tick,0);}
function haltQueue(){if(!queueIsBooted())return;queueIsBooted(false);log('['+PQ.name+'].halt');window.clearInterval(PQ.clock);}
function tick(){if(!queueIsBooted())return;if(queueIsPaused())return;if(queueIsTicking())return;queueIsTicking(true);log('['+PQ.name+'].tick');if(queueError()){warn('Has error(s)');queueIsTicking(false);throwErrors();haltQueue();return;}
if(pcAtHalt()){queueIsTicking(false);haltQueue();return;}
var thePC=PQ.processCounter,theProcess=PQ.nextProcess;pcIncrement();log('PC:'+thePC+'>>'+theProcess.name);queueIsRunning(true);try{theProcess.call(api,api,api.heap);}catch(e){fireError(e.message);}
queueIsRunning(false);queueIsTicking(false);}
function appendWaker(time){PQ.wakerStack.push(window.setTimeout(api.resume,time));}
function removeWakers(){while(PQ.wakerStack.length>0){window.clearTimeout(PQ.wakerStack.shift());}}
function pauseQueue(time){queueIsPaused(true);if(typeof time==='number')appendWaker(time);}
function resumeQueue(){queueIsPaused(false);removeWakers();}
for(var i=0,n=processArray.length;i<n;++i){var process=processArray[i];var name=process.name;var index=PQ.processStack.length;PQ.processStack.push(process);if(name!=='')PQ.processIndexs[name]=index;}
pcGoto((typeof initialProcessID==='number')?initialProcessID:0);if(typeof queueName==='string'&&queueName!==''){PQ.name=queueName;queueStack[queueName]=api;}else{PQ.name=String((new Date()).getTime());}
return wrapper;},core_version='2.4',PQUEUE_HALT=function PQUEUE_HALT(){},PQUEUE_BARRIER=function PQUEUE_BARRIER(queue){queue.pause();},_PQUEUE=window.PQUEUE,_PQUEUE_HALT=window.PQUEUE_HALT,_PQUEUE_BARRIER=window.PQUEUE_BARRIER;PQUEUE.PQUEUE=core_version;if(typeof window==="object"&&typeof window.document==="object"){window.PQUEUE=PQUEUE;window.PQUEUE_HALT=PQUEUE_HALT;window.PQUEUE_BARRIER=PQUEUE_BARRIER;}})(window,console);